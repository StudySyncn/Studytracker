<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>StudySync Pro Ultra</title>
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        :root {
            --primary: #38bdf8;
            --bg: #070b14;
            --card: rgba(30, 41, 59, 0.7);
        }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: var(--bg); 
            color: white; 
            padding: 20px; 
            display: flex; flex-direction: column; align-items: center;
        }

        /* GrÃ¡fico Circular */
        .stats-container { position: relative; width: 150px; height: 150px; margin: 20px; }
        svg { transform: rotate(-90deg); width: 150px; height: 150px; }
        circle {
            fill: none; stroke-width: 12; stroke-linecap: round;
            transition: stroke-dashoffset 0.8s ease;
        }
        .bg-circle { stroke: #1e293b; }
        .prog-circle { stroke: var(--primary); stroke-dasharray: 440; stroke-dashoffset: 440; }
        .perc-text {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem; font-weight: bold;
        }

        /* Controles */
        .input-group { 
            background: var(--card); padding: 20px; border-radius: 20px; 
            backdrop-filter: blur(10px); width: 100%; max-width: 400px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        input, select, button { 
            width: 100%; box-sizing: border-box; padding: 12px; margin: 8px 0; 
            border-radius: 12px; border: 1px solid #334155; background: #0f172a; color: white;
        }
        button { background: var(--primary); color: #070b14; font-weight: bold; border: none; font-size: 1rem; }
        button:active { transform: scale(0.98); }

        /* Lista de Tareas */
        .lista-tareas { width: 100%; max-width: 400px; margin-top: 20px; }
        .tarea-card {
            background: var(--card); padding: 15px; border-radius: 15px;
            margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;
            border-left: 4px solid var(--primary);
        }
        .meta { font-size: 0.8rem; color: #94a3b8; }
    </style>
</head>
<body>

    <h1 style="margin-bottom:0;">StudySync <span style="color:var(--primary)">Pro</span></h1>
    
    <div class="stats-container">
        <svg>
            <circle class="bg-circle" cx="75" cy="75" r="70"></circle>
            <circle id="circulo" class="prog-circle" cx="75" cy="75" r="70"></circle>
        </svg>
        <div id="porcentaje" class="perc-text">0%</div>
    </div>

    <div class="input-group">
        <input id="tarea" placeholder="Â¿QuÃ© vamos a lograr hoy?">
        <div style="display: flex; gap: 10px;">
            <input id="hora" type="time">
            <select id="categoria">
                <option value="ðŸ“š Estudio">ðŸ“š Estudio</option>
                <option value="âš½ Deporte">âš½ Deporte</option>
                <option value="ðŸŽ® Ocio">ðŸŽ® Ocio</option>
                <option value="âœ¨ Otros">âœ¨ Otros</option>
            </select>
        </div>
        <button onclick="agregar()">Agregar a mi plan</button>
    </div>

    <div id="lista" class="lista-tareas"></div>

    <script>
        let tareas = JSON.parse(localStorage.getItem("pro_tareas")) || [];

        function actualizar() {
            const lista = document.getElementById("lista");
            lista.innerHTML = "";
            let hechas = 0;

            tareas.forEach((t, i) => {
                if (t.done) hechas++;
                lista.innerHTML += `
                    <div class="tarea-card" style="opacity: ${t.done ? 0.6 : 1}">
                        <div>
                            <div style="${t.done ? 'text-decoration:line-through' : ''}">${t.text}</div>
                            <div class="meta">${t.cat} â€¢ ${t.time}</div>
                        </div>
                        <div>
                            <button onclick="check(${i})" style="width:40px; padding:5px; background:#22c55e">âœ“</button>
                            <button onclick="del(${i})" style="width:40px; padding:5px; background:#ef4444">X</button>
                        </div>
                    </div>`;
            });

            // LÃ³gica del CÃ­rculo (440 es el perÃ­metro aprox)
            let p = tareas.length > 0 ? (hechas / tareas.length) : 0;
            let offset = 440 - (p * 440);
            document.getElementById("circulo").style.strokeDashoffset = offset;
            document.getElementById("porcentaje").innerText = Math.round(p * 100) + "%";
            
            localStorage.setItem("pro_tareas", JSON.stringify(tareas));
        }

        function agregar() {
            const text = document.getElementById("tarea").value;
            const time = document.getElementById("hora").value;
            const cat = document.getElementById("categoria").value;
            if(!text) return;
            tareas.push({text, time, cat, done: false});
            document.getElementById("tarea").value = "";
            actualizar();
            if(Notification.permission === "granted") {
                new Notification("Â¡Tarea guardada!", {body: `Te avisarÃ© a las ${time}`});
            }
        }

        function check(i) { tareas[i].done = !tareas[i].done; actualizar(); }
        function del(i) { tareas.splice(i, 1); actualizar(); }

        window.onload = () => {
            actualizar();
            if(Notification.permission !== "denied") Notification.requestPermission();
        };
    </script>
</body>
</html>
