<!DOCTYPE html>
<html>
<head>
    <title>StudySync Pro</title>
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        body { font-family: sans-serif; background: #0f172a; color: white; padding: 20px; text-align: center; }
        h1 { color: #38bdf8; }
        
        /* Estilo de la Barra de Progreso */
        .progress-container { background: #1e293b; border-radius: 10px; height: 20px; width: 100%; margin: 20px 0; }
        .progress-bar { background: #38bdf8; height: 100%; width: 0%; border-radius: 10px; transition: 0.5s; }
        
        input, select, button { padding: 12px; margin: 5px; border-radius: 8px; border: none; }
        button { background: #38bdf8; color: #0f172a; font-weight: bold; cursor: pointer; }
        .tarea-item { background: #1e293b; padding: 15px; margin: 10px 0; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; }
        .importante { border-left: 5px solid #ef4444; }
    </style>
</head>
<body>

    <h1>StudySync Pro ðŸš€</h1>
    
    <div class="progress-container">
        <div id="barra" class="progress-bar"></div>
    </div>
    <p id="porcentaje">0% completado</p>

    <input id="tarea" placeholder="Escribe tu tarea">
    <input id="hora" type="time">
    <select id="prioridad">
        <option value="Normal">Normal</option>
        <option value="Importante">ðŸ”¥ Importante</option>
    </select>
    <button onclick="agregarTarea()">Agregar</button>

    <ul id="lista" style="list-style: none; padding: 0;"></ul>

    <script>
        let tareas = JSON.parse(localStorage.getItem("tareas")) || [];

        window.onload = () => {
            actualizarInterfaz();
            Notification.requestPermission(); 
        };

        function agregarTarea() {
            let texto = document.getElementById("tarea").value;
            let hora = document.getElementById("hora").value;
            let prioridad = document.getElementById("prioridad").value;
            
            if (texto === "") return;

            let nuevaTarea = { texto, hora, prioridad, completada: false };
            tareas.push(nuevaTarea);
            guardarYActualizar();
            programarNotificacion(texto, hora);
            document.getElementById("tarea").value = "";
        }

        function programarNotificacion(texto, hora) {
            if (!hora) return;
            let [h, m] = hora.split(":");
            let fechaTarea = new Date();
            fechaTarea.setHours(h, m, 0);
            
            let tiempo = fechaTarea - new Date();
            if (tiempo > 0) {
                setTimeout(() => {
                    new Notification("â° StudySync Pro", { body: `Â¡Es hora de: ${texto}!` });
                }, tiempo);
            }
        }

        function completarTarea(index) {
            tareas[index].completada = !tareas[index].completada;
            guardarYActualizar();
        }

        function eliminarTarea(index) {
            tareas.splice(index, 1);
            guardarYActualizar();
        }

        function guardarYActualizar() {
            localStorage.setItem("tareas", JSON.stringify(tareas));
            actualizarInterfaz();
        }

        function actualizarInterfaz() {
            const lista = document.getElementById("lista");
            lista.innerHTML = "";
            let hechas = 0;

            tareas.forEach((t, i) => {
                if (t.completada) hechas++;
                lista.innerHTML += `
                    <div class="tarea-item ${t.prioridad === 'Importante' ? 'importante' : ''}">
                        <span style="${t.completada ? 'text-decoration: line-through; opacity: 0.5;' : ''}">
                            [${t.prioridad}] ${t.texto} - ${t.hora}
                        </span>
                        <div>
                            <button onclick="completarTarea(${i})">âœ…</button>
                            <button onclick="eliminarTarea(${i})" style="background:#ef4444;">X</button>
                        </div>
                    </div>`;
            });

            // LÃ³gica de la barra de porcentaje
            let porc = tareas.length > 0 ? Math.round((hechas / tareas.length) * 100) : 0;
            document.getElementById("barra").style.width = porc + "%";
            document.getElementById("porcentaje").innerText = porc + "% completado";
        }
    </script>
</body>
</html>
